<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2014-05-14 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20140514" />
    <meta http-equiv="Content-Language" content="en" />
    <title>splitlog: Watching Your Logs - Splitlog User Guide</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.1.min.js"></script>

    
                  </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/triceo/splitlog">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>splitlog: watching your logs</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2014-05-14
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 1.6.0-RC2
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Usage</li>
                              
      <li>
  
                          <a href="../user_guide/introduction.html" title="Introduction">
          <i class="none"></i>
        Introduction</a>
            </li>
                                                                                                
      <li>
  
                          <a href="../user_guide/features.html" title="Features">
          <i class="icon-chevron-down"></i>
        Features</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="../user_guide/metrics.html" title="Metrics">
          <i class="none"></i>
        Metrics</a>
            </li>
                    
      <li>
  
                          <a href="../user_guide/merging.html" title="Merging Followers">
          <i class="none"></i>
        Merging Followers</a>
            </li>
                    
      <li>
  
                          <a href="../user_guide/expectations.html" title="Expectations">
          <i class="none"></i>
        Expectations</a>
            </li>
              </ul>
        </li>
                                                                                                          
      <li>
  
                          <a href="../user_guide/advanced.html" title="Deep Down">
          <i class="icon-chevron-down"></i>
        Deep Down</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="../user_guide/message_lifecycle.html" title="Message Lifecycle">
          <i class="none"></i>
        Message Lifecycle</a>
            </li>
                    
      <li>
  
                          <a href="../user_guide/splitting.html" title="Splitting">
          <i class="none"></i>
        Splitting</a>
            </li>
                    
      <li class="active">
  
            <a href="#"><i class="none"></i>Memory Management</a>
          </li>
              </ul>
        </li>
                
      <li>
  
                          <a href="../faq.html" title="Frequently Asked Questions">
          <i class="none"></i>
        Frequently Asked Questions</a>
            </li>
                                        <li class="nav-header">Modules</li>
                              
      <li>
  
                          <a href="../splitlog-api/index.html" title="splitlog-api: the public APIs">
          <i class="none"></i>
        splitlog-api: the public APIs</a>
            </li>
                
      <li>
  
                          <a href="../splitlog-core/index.html" title="splitlog-core: the client library">
          <i class="none"></i>
        splitlog-core: the client library</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                                                                              
      <li>
  
                          <a href="../project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                                                                                                                                                                  
      <li>
  
                          <a href="../project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                            <form id="search-form" action="http://www.google.com/search" method="get" >
    
  <input value="$sitesearchValue" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section">
<h2>Splitlog User Guide<a name="Splitlog_User_Guide"></a></h2>
<div class="section">
<h3>Advanced <i>Splitlog</i> Concepts: Memory Management<a name="Advanced_Splitlog_Concepts:_Memory_Management"></a></h3>
<p>This chapter will explain how <i>Splitlog</i> stores <tt>Message</tt> instances and will provide tips towards minimizing its memory consumption. </p>
<div class="section">
<h4>Message store<a name="Message_store"></a></h4>
<p>Any message in the <tt>ACCEPTED</tt> state (see <a href="message_lifecycle.html">Message Lifecycle</a> will be stored inside <i>Splitlog</i>&#x2019;s in-memory data store. Only messages stored here will be available for followers to retrieve.</p>
<p>Obviously, as the log files watched by <i>Splitlog</i> grow in size, so will the amount of memory that is required to store all those <tt>Message</tt> instances. To this end, <i>Splitlog</i> implements some smart techniques to help keep the memory consumption down. But it may need your cooperation.</p></div>
<div class="section">
<h4>Weak referencing<a name="Weak_referencing"></a></h4>
<p>The <i>Java Virtual Machine</i> supports two kinds of object references, weak and strong. Garbage collectors won&#x2019;t remove objects from memory for as long as there are strong references to them. And <i>Splitlog</i>&#x2019;s internals will only store <tt>Message</tt>s as weak references - as long as there&#x2019;s nothing else pointing to those <tt>Message</tt> instances, they will be garbage-collected. So, what else can be pointing to those instances?</p>

<ul>
  
<li>You. Anytime you keep a reference to <tt>Message</tt> for any longer than you actually need it, you are preventing it, and every one of its predecessors, from being garbage-collected.</li>
  
<li>Followers. No message will ever be garbage-collected for as long as there are <tt>CommonFollower</tt> instances that have been notified of it. If memory consumption is your concern, it is highly recommended you throw follower references away immediately after you&#x2019;ve stopped the follower.</li>
</ul>
<p>Keep in mind that <i>Splitlog</i> is very smart here. If you stop a particular follower, it will throw away all messages no longer accessible through any other follower. It will be impossible, from that point, to retrieve those messages in any way. When the strong references are gone, the messages are gone as well, for good.</p></div>
<div class="section">
<h4>Keeping the memory consumption down<a name="Keeping_the_memory_consumption_down"></a></h4>
<p>There are some tips and tricks that you can leverage to manage <i>Splitlog</i>&#x2019;s memory consumption.</p>

<ul>
  
<li>Gate your messages. You can prevent whole messages from being processed by <i>Splitlog</i> at all, and that includes storage.</li>
  
<li>Reject unwanted messages. If you let a message through the gate, consumers will be informed of it. But even then, you can reject the message from being stored. But remember - message not stored is message not accessible for retrieval later.</li>
  
<li>Limit message store capacity. Message store is a queue, and an unbounded one by default. You can limit its capacity and when the limit is reached, the first message in the queue will be removed. And as you are well aware by now, this will cause the message to not be available any more.</li>
</ul>
<p>All of these can be accomplished through <tt>LogWatchBuilder</tt>. But the most important thing you can do is this: <b>write clean code!</b> Properly limit the scope of your variables, don&#x2019;t store what doesn&#x2019;t need to be stored. The <i>JVM</i> will handle the rest for you.</p>
<div class="section">
<h5>References<a name="References"></a></h5>

<ol style="list-style-type: decimal">
  
<li><a href="../apidocs/com/github/triceo/splitlog/api/LogWatchBuilder.html">LogWatchBuilder Javadoc</a>.</li>
</ol>
<p>&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;-</p></div>
<div class="section">
<h5>Something wrong?<a name="Something_wrong"></a></h5>
<p>Think you spotted a mistake in this document? A typo? Factual inaccuracy? <a class="externalLink" href="https://github.com/triceo/splitlog/edit/master/src/site/markdown/user_guide/memory.md.vm">Make an edit</a>. Think of the legions of grateful users!</p></div></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                        <p class="pull-right">Copyright &copy;                   2014.
          All rights reserved.      
                    
      </p>
        </div>

        
        
          
    
    
                
    <div id="ohloh" class="pull-right">
      <script type="text/javascript" src="http://www.ohloh.net/p/715136/widgets/project_factoids.js"></script>
    </div>
        </div>
    </footer>
        </body>
</html>
